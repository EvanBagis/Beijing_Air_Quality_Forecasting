# Beijing_Air_Quality_Forecasting
## Introduction

This repository implements teo (3) different forecasting frameworks. The frameworks are tested on the [Beijing Air Quality Dataset](https://archive.ics.uci.edu/dataset/501/beijing+multi+site+air+quality+data).

- **Approach 1: Incremental recursive forecasting** uses the river python library to implement an incremental forecasting model that aims to forecast 12 hours in the future. The model accepts 24 lag features from the time series that will be forecasted. The approach is a recursive one where the model initially accepts the last 24 observations to predict the future value one step ahead. The prediction becomes the last value of the input instance to predict the future value 2 steps ahead and so on. The model is implemented with the [river](https://riverml.xyz/0.21.0/) package.

- **Batch recursive forecasting**



- **Batch multioutput forecasting**





### Conceptual framework






### Results

### Incremental recursive forecasting

<p align="center">O3 Forecasting (incremental recursive)</p>

<div align="center"> 

|                  |    RMSE |     MAE |       r2 |   Pearson |   Spearman |     MBE |       IA |
|:-----------------|--------:|--------:|---------:|----------:|-----------:|--------:|---------:|
| O3_Aotizhongxin  | 37.2926 | 26.0634 | 0.580813 |  0.767332 |   0.725385 | 1.54928 | 0.867765 |
| O3_Changping     | 37.2639 | 25.82   | 0.531569 |  0.736825 |   0.717908 | 1.16114 | 0.847615 |
| O3_Dingling      | 42.4422 | 27.7365 | 0.590547 |  0.778291 |   0.714402 | 1.00072 | 0.875868 |
| O3_Dongsi        | 43.5108 | 26.0964 | 0.450383 |  0.685029 |   0.727775 | 2.23128 | 0.810735 |
| O3_Guanyuan      | 37.8856 | 26.3388 | 0.56273  |  0.756244 |   0.723974 | 1.55226 | 0.860735 |
| O3_Gucheng       | 36.7106 | 25.9657 | 0.602942 |  0.78107  |   0.721255 | 1.9712  | 0.876157 |
| O3_Huairou       | 38.4224 | 26.8581 | 0.550955 |  0.750594 |   0.698576 | 1.95355 | 0.857386 |
| O3_Nongzhanguan  | 38.2415 | 27.238  | 0.571042 |  0.76149  |   0.705387 | 1.69256 | 0.863666 |
| O3_Shunyi        | 37.5229 | 26.3415 | 0.532797 |  0.736631 |   0.680223 | 1.72882 | 0.84755  |
| O3_Tiantan       | 42.6512 | 27.9689 | 0.508904 |  0.722789 |   0.710817 | 1.60687 | 0.838449 |
| O3_Wanliu        | 35.4547 | 24.212  | 0.576317 |  0.764719 |   0.699465 | 1.67322 | 0.866211 |
| O3_Wanshouxigong | 36.8785 | 26.0998 | 0.584091 |  0.769595 |   0.721341 | 1.52191 | 0.868985 |

</div> 

![](https://github.com/EvanBagis/Beijing_Air_Quality_Forecasting/blob/master/gifs/O3/incremental_recursive_O3_Aotizhongxin.gif)





<p align="center">PM10 Forecasting (incremental recursive)</p>

<div align="center"> 

|                    |    RMSE |     MAE |       r2 |   Pearson |   Spearman |      MBE |       IA |
|:-------------------|--------:|--------:|---------:|----------:|-----------:|---------:|---------:|
| PM10_Aotizhongxin  | 84.8484 | 58.0001 | 0.208493 |  0.52876  |   0.53427  | -3.15336 | 0.716223 |
| PM10_Changping     | 73.8563 | 48.8643 | 0.227034 |  0.540253 |   0.547664 | -2.36222 | 0.7214   |
| PM10_Dingling      | 69.8128 | 45.5864 | 0.243429 |  0.558551 |   0.553931 | -2.54191 | 0.737221 |
| PM10_Dongsi        | 87.026  | 59.5741 | 0.214284 |  0.52884  |   0.511728 | -3.21358 | 0.713904 |
| PM10_Guanyuan      | 83.1785 | 57.0067 | 0.191209 |  0.516584 |   0.507274 | -3.69235 | 0.707711 |
| PM10_Gucheng       | 88.4208 | 62.4609 | 0.180024 |  0.496769 |   0.484002 | -4.05399 | 0.690914 |
| PM10_Huairou       | 75.1911 | 49.9608 | 0.219837 |  0.532665 |   0.547989 | -1.7549  | 0.716834 |
| PM10_Nongzhanguan  | 85.1352 | 58.4747 | 0.216752 |  0.52916  |   0.511797 | -2.36542 | 0.714223 |
| PM10_Shunyi        | 81.1966 | 54.6948 | 0.217995 |  0.523713 |   0.529963 | -1.49972 | 0.706658 |
| PM10_Tiantan       | 80.5486 | 55.3241 | 0.206613 |  0.518276 |   0.50125  | -2.61189 | 0.704961 |
| PM10_Wanliu        | 82.7469 | 57.1799 | 0.218619 |  0.542593 |   0.519999 | -4.8261  | 0.7278   |
| PM10_Wanshouxigong | 88.2194 | 60.7918 | 0.201042 |  0.514538 |   0.484502 | -2.8851  | 0.703938 |

</div> 

![](https://github.com/EvanBagis/Beijing_Air_Quality_Forecasting/blob/master/gifs/PM10/incremental_recursive_PM10_Aotizhongxin.gif)




<p align="center">PM2.5 Forecasting (incremental recursive)</p>

<div align="center"> 

|                     |    RMSE |     MAE |       r2 |   Pearson |   Spearman |        MBE |       IA |
|:--------------------|--------:|--------:|---------:|----------:|-----------:|-----------:|---------:|
| PM2.5_Aotizhongxin  | 70.5705 | 45.4768 | 0.264615 |  0.575129 |   0.56759  | -0.884923  | 0.750771 |
| PM2.5_Changping     | 60.6511 | 38.389  | 0.298753 |  0.608273 |   0.606474 | -1.83955   | 0.774641 |
| PM2.5_Dingling      | 61.3019 | 38.1351 | 0.328828 |  0.628521 |   0.604914 | -1.17287   | 0.787714 |
| PM2.5_Dongsi        | 74.0451 | 48.6503 | 0.264529 |  0.571531 |   0.551357 | -1.46869   | 0.746852 |
| PM2.5_Guanyuan      | 69.0452 | 45.0745 | 0.278921 |  0.5875   |   0.560025 | -1.83562   | 0.759874 |
| PM2.5_Gucheng       | 69.1932 | 45.2245 | 0.308901 |  0.600766 |   0.558445 | -0.819572  | 0.766212 |
| PM2.5_Huairou       | 60.5294 | 38.346  | 0.277289 |  0.59203  |   0.599341 | -1.62169   | 0.763133 |
| PM2.5_Nongzhanguan  | 74.3062 | 48.5555 | 0.270333 |  0.572537 |   0.554079 | -0.0876712 | 0.746632 |
| PM2.5_Shunyi        | 68.9549 | 45.0852 | 0.294588 |  0.589975 |   0.565498 | -0.166875  | 0.758274 |
| PM2.5_Tiantan       | 69.247  | 45.8418 | 0.271561 |  0.577127 |   0.551569 | -0.981861  | 0.751592 |
| PM2.5_Wanliu        | 67.8309 | 43.7782 | 0.318736 |  0.612865 |   0.586164 | -1.92238   | 0.776467 |
| PM2.5_Wanshouxigong | 74.3531 | 48.5015 | 0.26339  |  0.56782  |   0.538682 | -0.522217  | 0.743766 |

</div> 

![](https://github.com/EvanBagis/Beijing_Air_Quality_Forecasting/blob/master/gifs/PM2.5/incremental_recursive_PM2.5_Aotizhongxin.gif)





<p align="center">NO2 Forecasting (incremental recursive)</p>

<div align="center"> 

|                   |    RMSE |     MAE |       r2 |   Pearson |   Spearman |       MBE |       IA |
|:------------------|--------:|--------:|---------:|----------:|-----------:|----------:|---------:|
| NO2_Aotizhongxin  | 32.1402 | 23.834  | 0.24566  |  0.543479 |   0.527637 | -0.838969 | 0.725801 |
| NO2_Changping     | 25.2256 | 18.6075 | 0.276202 |  0.566981 |   0.526763 | -0.74235  | 0.740022 |
| NO2_Dingling      | 21.6506 | 14.3372 | 0.32332  |  0.61206  |   0.562815 | -0.476287 | 0.775466 |
| NO2_Dongsi        | 29.7603 | 21.8094 | 0.254994 |  0.556854 |   0.533432 | -1.03003  | 0.737949 |
| NO2_Guanyuan      | 30.5643 | 22.5363 | 0.246508 |  0.556432 |   0.535726 | -1.55319  | 0.738516 |
| NO2_Gucheng       | 32.8889 | 24.6184 | 0.189728 |  0.512663 |   0.475695 | -1.11494  | 0.711579 |
| NO2_Huairou       | 22.1836 | 15.4131 | 0.288623 |  0.586366 |   0.588083 | -0.806725 | 0.75657  |
| NO2_Nongzhanguan  | 32.073  | 24.0664 | 0.226855 |  0.532609 |   0.503358 | -1.03677  | 0.72048  |
| NO2_Shunyi        | 27.2231 | 19.9532 | 0.258704 |  0.552892 |   0.51279  | -0.406913 | 0.733085 |
| NO2_Tiantan       | 27.5522 | 20.572  | 0.258563 |  0.55472  |   0.527737 | -1.15421  | 0.732978 |
| NO2_Wanliu        | 31.3144 | 23.1851 | 0.32951  |  0.612353 |   0.58637  | -1.53243  | 0.775101 |
| NO2_Wanshouxigong | 30.9517 | 22.8474 | 0.264488 |  0.569695 |   0.543399 | -1.60543  | 0.747852 |

</div> 

![](https://github.com/EvanBagis/Beijing_Air_Quality_Forecasting/blob/master/gifs/NO2/incremental_recursive_NO2_Aotizhongxin.gif)





<p align="center">SO2 Forecasting (incremental recursive)</p>

<div align="center"> 

|                   |    RMSE |      MAE |       r2 |   Pearson |   Spearman |      MBE |       IA |
|:------------------|--------:|---------:|---------:|----------:|-----------:|---------:|---------:|
| SO2_Aotizhongxin  | 17.5957 |  9.94094 | 0.405764 |  0.660785 |   0.727234 | 0.50315  | 0.79737  |
| SO2_Changping     | 15.488  |  8.53688 | 0.461465 |  0.693633 |   0.70123  | 0.52312  | 0.818145 |
| SO2_Dingling      | 12.5547 |  7.10407 | 0.35079  |  0.619855 |   0.633161 | 0.426143 | 0.769131 |
| SO2_Dongsi        | 17.7219 | 10.5564  | 0.405262 |  0.661194 |   0.682633 | 0.569823 | 0.799868 |
| SO2_Guanyuan      | 18.2275 | 10.2529  | 0.406012 |  0.66597  |   0.695198 | 0.316552 | 0.804158 |
| SO2_Gucheng       | 21.3597 |  8.73324 | 0.375979 |  0.650819 |   0.773658 | 0.404314 | 0.788993 |
| SO2_Huairou       | 14.9549 |  7.57749 | 0.375687 |  0.635847 |   0.646182 | 0.697864 | 0.776559 |
| SO2_Nongzhanguan  | 18.7322 | 10.9286  | 0.411181 |  0.668457 |   0.682571 | 0.43214  | 0.80588  |
| SO2_Shunyi        | 16.1294 |  8.8399  | 0.320221 |  0.598675 |   0.626344 | 0.874689 | 0.752368 |
| SO2_Tiantan       | 16.7737 |  9.18497 | 0.331436 |  0.604356 |   0.631442 | 0.78808  | 0.754049 |
| SO2_Wanliu        | 16.2063 |  9.31157 | 0.492537 |  0.716731 |   0.762933 | 0.26166  | 0.835994 |
| SO2_Wanshouxigong | 18.4314 | 10.1786  | 0.423608 |  0.672614 |   0.724283 | 0.556321 | 0.806141 |

</div> 

![](https://github.com/EvanBagis/Beijing_Air_Quality_Forecasting/blob/master/gifs/SO2/incremental_recursive_SO2_Aotizhongxin.gif)





<p align="center">CO Forecasting (incremental recursive)</p>

<div align="center"> 

|                  |     RMSE |     MAE |       r2 |   Pearson |   Spearman |       MBE |       IA |
|:-----------------|---------:|--------:|---------:|----------:|-----------:|----------:|---------:|
| CO_Aotizhongxin  |  996.087 | 608.716 | 0.357137 |  0.627091 |   0.555932 |  14.7712  | 0.778376 |
| CO_Changping     |  927.816 | 547.219 | 0.322649 |  0.611661 |   0.580772 | -10.8803  | 0.7691   |
| CO_Dingling      |  729.551 | 425.373 | 0.339916 |  0.62302  |   0.609657 |   8.79241 | 0.778737 |
| CO_Dongsi        |  971.439 | 595.987 | 0.346132 |  0.619248 |   0.549353 |   3.31989 | 0.775302 |
| CO_Guanyuan      |  958.623 | 594.581 | 0.310562 |  0.598481 |   0.531333 |  -9.9627  | 0.761523 |
| CO_Gucheng       |  960.27  | 589.213 | 0.396981 |  0.665008 |   0.58467  | -37.5254  | 0.80828  |
| CO_Huairou       |  793.658 | 477.928 | 0.213718 |  0.549488 |   0.547558 | -10.4776  | 0.7303   |
| CO_Nongzhanguan  | 1051.09  | 657.388 | 0.304189 |  0.591534 |   0.520793 |   3.71418 | 0.755517 |
| CO_Shunyi        | 1017.39  | 620.916 | 0.245915 |  0.557097 |   0.523942 |   7.34218 | 0.733372 |
| CO_Tiantan       |  982.117 | 619.672 | 0.312672 |  0.601139 |   0.516291 |  -3.59658 | 0.764394 |
| CO_Wanliu        | 1017.03  | 619.789 | 0.356805 |  0.632845 |   0.571347 | -10.8251  | 0.784974 |
| CO_Wanshouxigong | 1013.11  | 644.306 | 0.331338 |  0.612256 |   0.530534 |   2.19124 | 0.771517 |

</div> 

![](https://github.com/EvanBagis/Beijing_Air_Quality_Forecasting/blob/master/gifs/CO/incremental_recursive_CO_Aotizhongxin.gif)

### Batch multioutput forecasting

<p align="center">O3 Forecasting (batch multioutput)</p>

<div align="center"> 

|               |    RMSE |     MAE |       r2 |   Pearson |   Spearman |      MBE |       IA |
|:--------------|--------:|--------:|---------:|----------:|-----------:|---------:|---------:|
| Aotizhongxin  | 37.6962 | 25.8076 | 0.61159  |  0.806601 |   0.781097 |  9.50025 | 0.856108 |
| Changping     | 31.3951 | 22.3429 | 0.643927 |  0.806057 |   0.779314 | -3.71108 | 0.879797 |
| Dingling      | 43.0473 | 25.1227 | 0.684604 |  0.851826 |   0.805519 |  4.86695 | 0.878677 |
| Dongsi        | 33.1928 | 23.3716 | 0.625454 |  0.792276 |   0.766736 |  1.06803 | 0.869076 |
| Guanyuan      | 35.1316 | 24.1475 | 0.635749 |  0.803255 |   0.783022 |  3.9991  | 0.870634 |
| Gucheng       | 35.1419 | 24.4862 | 0.646369 |  0.815062 |   0.781348 |  4.71532 | 0.871144 |
| Huairou       | 34.3792 | 23.7178 | 0.605081 |  0.780077 |   0.758298 | -2.15323 | 0.858968 |
| Nongzhanguan  | 34.337  | 24.0633 | 0.653988 |  0.812049 |   0.772972 |  2.78491 | 0.880194 |
| Shunyi        | 34.4563 | 24.357  | 0.599267 |  0.776823 |   0.703381 | -3.22159 | 0.860542 |
| Tiantan       | 36.7411 | 26.1049 | 0.620761 |  0.791352 |   0.754989 |  3.19673 | 0.865335 |
| Wanliu        | 36.9469 | 25.0502 | 0.596775 |  0.804121 |   0.76014  |  9.6077  | 0.845146 |
| Wanshouxigong | 33.7999 | 23.8154 | 0.654517 |  0.815066 |   0.78025  |  3.74398 | 0.878647 |

</div> 

![](https://github.com/EvanBagis/Beijing_Air_Quality_Forecasting/blob/master/gifs/O3/batch_multioutput_O3_Aotizhongxin.gif)


<p align="center">PM10 Forecasting (batch multioutput)</p>

<div align="center"> 

|               |    RMSE |     MAE |       r2 |   Pearson |   Spearman |        MBE |       IA |
|:--------------|--------:|--------:|---------:|----------:|-----------:|-----------:|---------:|
| Aotizhongxin  | 64.3116 | 40.6234 | 0.547061 |  0.744818 |   0.762403 |  -8.33152  | 0.839426 |
| Changping     | 55.8208 | 33.8167 | 0.552936 |  0.745813 |   0.74858  |  -4.36724  | 0.844053 |
| Dingling      | 53.6646 | 31.2724 | 0.544393 |  0.73927  |   0.753111 |   0.126763 | 0.843553 |
| Dongsi        | 67.5287 | 41.8819 | 0.571218 |  0.757333 |   0.764694 |  -1.56334  | 0.839886 |
| Guanyuan      | 63.6894 | 40.0013 | 0.563244 |  0.751407 |   0.765232 |  -1.92791  | 0.838572 |
| Gucheng       | 68.9622 | 45.3363 | 0.522676 |  0.724202 |   0.724902 |  -4.07813  | 0.821576 |
| Huairou       | 55.5742 | 34.8078 | 0.556762 |  0.7556   |   0.765654 |  -8.59022  | 0.853776 |
| Nongzhanguan  | 62.3755 | 39.8507 | 0.574726 |  0.761537 |   0.769103 |  -6.57219  | 0.847211 |
| Shunyi        | 60.5366 | 37.9214 | 0.566162 |  0.756911 |   0.773732 |  -7.14341  | 0.850992 |
| Tiantan       | 61.7529 | 38.5223 | 0.563786 |  0.753957 |   0.759998 |  -5.23386  | 0.837675 |
| Wanliu        | 60.3049 | 39.5137 | 0.550269 |  0.759339 |   0.75623  | -14.4194   | 0.848474 |
| Wanshouxigong | 63.8524 | 40.7834 | 0.564132 |  0.754701 |   0.754097 |  -6.38522  | 0.839596 |

</div> 

![](https://github.com/EvanBagis/Beijing_Air_Quality_Forecasting/blob/master/gifs/PM10/batch_multioutput_PM10_Aotizhongxin.gif)


<p align="center">PM2.5 Forecasting (batch multioutput)</p>

<div align="center"> 

|               |    RMSE |     MAE |       r2 |   Pearson |   Spearman |      MBE |       IA |
|:--------------|--------:|--------:|---------:|----------:|-----------:|---------:|---------:|
| Aotizhongxin  | 49.7992 | 30.7268 | 0.654233 |  0.810851 |   0.793174 | -3.84771 | 0.88339  |
| Changping     | 41.4539 | 24.8513 | 0.630371 |  0.803513 |   0.789814 | -7.09749 | 0.887952 |
| Dingling      | 42.6329 | 24.2697 | 0.657281 |  0.813119 |   0.794517 | -3.8056  | 0.893362 |
| Dongsi        | 52.8132 | 32.4778 | 0.651547 |  0.80853  |   0.788313 | -1.62594 | 0.880598 |
| Guanyuan      | 48.6865 | 30.0363 | 0.664424 |  0.816379 |   0.796304 | -2.16007 | 0.887169 |
| Gucheng       | 50.3752 | 30.6421 | 0.663202 |  0.815879 |   0.789461 | -2.48588 | 0.886489 |
| Huairou       | 39.5014 | 24.1708 | 0.690449 |  0.834195 |   0.817601 | -5.21228 | 0.903462 |
| Nongzhanguan  | 50.7315 | 31.6552 | 0.662598 |  0.815763 |   0.796833 | -4.38175 | 0.888786 |
| Shunyi        | 50.0615 | 30.7882 | 0.654896 |  0.810766 |   0.800365 | -2.83417 | 0.88265  |
| Tiantan       | 49.0045 | 30.2317 | 0.653305 |  0.810468 |   0.794433 | -4.62232 | 0.884257 |
| Wanliu        | 46.3563 | 28.7795 | 0.672507 |  0.824952 |   0.797027 | -7.25446 | 0.895765 |
| Wanshouxigong | 52.9608 | 32.3628 | 0.65073  |  0.808494 |   0.781125 | -3.36041 | 0.880668 |

</div> 

![](https://github.com/EvanBagis/Beijing_Air_Quality_Forecasting/blob/master/gifs/PM2.5/batch_multioutput_PM2.5_Aotizhongxin.gif)

<div align="center"> 

|               |    RMSE |     MAE |       r2 |   Pearson |   Spearman |      MBE |       IA |
|:--------------|--------:|--------:|---------:|----------:|-----------:|---------:|---------:|
| Aotizhongxin  | 49.7992 | 30.7268 | 0.654233 |  0.810851 |   0.793174 | -3.84771 | 0.88339  |
| Changping     | 41.4539 | 24.8513 | 0.630371 |  0.803513 |   0.789814 | -7.09749 | 0.887952 |
| Dingling      | 42.6329 | 24.2697 | 0.657281 |  0.813119 |   0.794517 | -3.8056  | 0.893362 |
| Dongsi        | 52.8132 | 32.4778 | 0.651547 |  0.80853  |   0.788313 | -1.62594 | 0.880598 |
| Guanyuan      | 48.6865 | 30.0363 | 0.664424 |  0.816379 |   0.796304 | -2.16007 | 0.887169 |
| Gucheng       | 50.3752 | 30.6421 | 0.663202 |  0.815879 |   0.789461 | -2.48588 | 0.886489 |
| Huairou       | 39.5014 | 24.1708 | 0.690449 |  0.834195 |   0.817601 | -5.21228 | 0.903462 |
| Nongzhanguan  | 50.7315 | 31.6552 | 0.662598 |  0.815763 |   0.796833 | -4.38175 | 0.888786 |
| Shunyi        | 50.0615 | 30.7882 | 0.654896 |  0.810766 |   0.800365 | -2.83417 | 0.88265  |
| Tiantan       | 49.0045 | 30.2317 | 0.653305 |  0.810468 |   0.794433 | -4.62232 | 0.884257 |
| Wanliu        | 46.3563 | 28.7795 | 0.672507 |  0.824952 |   0.797027 | -7.25446 | 0.895765 |
| Wanshouxigong | 52.9608 | 32.3628 | 0.65073  |  0.808494 |   0.781125 | -3.36041 | 0.880668 |

</div> 

![](https://github.com/EvanBagis/Beijing_Air_Quality_Forecasting/blob/master/gifs/PM2.5/batch_multioutput_PM2.5_Aotizhongxin.gif)


<p align="center">NO2 Forecasting (batch multioutput)</p>

<div align="center"> 

|               |    RMSE |     MAE |       r2 |   Pearson |   Spearman |        MBE |       IA |
|:--------------|--------:|--------:|---------:|----------:|-----------:|-----------:|---------:|
| Aotizhongxin  | 25.6428 | 19.6002 | 0.537384 |  0.755232 |   0.725098 | -5.93672   | 0.822888 |
| Changping     | 21.3108 | 15.7891 | 0.494734 |  0.706005 |   0.675228 |  0.0051371 | 0.794145 |
| Dingling      | 17.2098 | 11.2821 | 0.553638 |  0.746648 |   0.731801 | -0.295019  | 0.829046 |
| Dongsi        | 22.6153 | 17.2241 | 0.534851 |  0.747807 |   0.707602 | -4.92536   | 0.828475 |
| Guanyuan      | 24.0956 | 18.0537 | 0.516266 |  0.740683 |   0.703264 | -5.91969   | 0.819118 |
| Gucheng       | 25.5335 | 19.2045 | 0.449262 |  0.699036 |   0.684856 | -6.82521   | 0.794913 |
| Huairou       | 17.7875 | 13.1305 | 0.475559 |  0.714645 |   0.705408 | -4.59684   | 0.805497 |
| Nongzhanguan  | 24.3845 | 18.7167 | 0.528894 |  0.747417 |   0.713787 | -5.84975   | 0.825932 |
| Shunyi        | 22.5725 | 16.847  | 0.486402 |  0.706982 |   0.685747 | -3.56224   | 0.80307  |
| Tiantan       | 23.0237 | 17.1967 | 0.48505  |  0.706948 |   0.675135 | -2.89919   | 0.787205 |
| Wanliu        | 25.3436 | 19.2246 | 0.532991 |  0.757208 |   0.730158 | -7.20787   | 0.831359 |
| Wanshouxigong | 23.2685 | 17.4543 | 0.539489 |  0.755121 |   0.723162 | -5.78421   | 0.832381 |

</div> 

![](https://github.com/EvanBagis/Beijing_Air_Quality_Forecasting/blob/master/gifs/NO2/batch_multioutput_NO2_Aotizhongxin.gif)


<p align="center">SO2 Forecasting (batch multioutput)</p>

<div align="center"> 

|               |     RMSE |     MAE |       r2 |   Pearson |   Spearman |       MBE |       IA |
|:--------------|---------:|--------:|---------:|----------:|-----------:|----------:|---------:|
| Aotizhongxin  |  9.41717 | 5.94078 | 0.598084 |  0.786951 |   0.773936 | -2.13404  | 0.860245 |
| Changping     |  8.21391 | 5.30421 | 0.447296 |  0.73594  |   0.718247 | -2.93525  | 0.83223  |
| Dingling      |  6.3289  | 4.17461 | 0.5617   |  0.762602 |   0.694864 | -1.27574  | 0.85426  |
| Dongsi        |  9.57258 | 6.28033 | 0.590012 |  0.782443 |   0.774283 | -2.13226  | 0.8533   |
| Guanyuan      |  9.71964 | 5.94648 | 0.588246 |  0.777132 |   0.769666 | -1.83237  | 0.852689 |
| Gucheng       | 10.3407  | 5.51595 | 0.5363   |  0.743397 |   0.770872 | -1.91283  | 0.834494 |
| Huairou       |  6.96704 | 4.44275 | 0.412914 |  0.724626 |   0.667835 | -2.33098  | 0.830356 |
| Nongzhanguan  |  9.57699 | 6.32369 | 0.594042 |  0.78743  |   0.768046 | -2.42188  | 0.861904 |
| Shunyi        |  8.7439  | 5.15299 | 0.563004 |  0.752531 |   0.734346 | -0.741619 | 0.840321 |
| Tiantan       |  8.89813 | 5.54211 | 0.449727 |  0.693034 |   0.673742 | -1.91445  | 0.802268 |
| Wanliu        |  8.9188  | 6.00794 | 0.621416 |  0.811395 |   0.80012  | -2.77723  | 0.879214 |
| Wanshouxigong | 10.0654  | 6.03403 | 0.566665 |  0.761953 |   0.766499 | -1.79577  | 0.844541 |

</div> 

![](https://github.com/EvanBagis/Beijing_Air_Quality_Forecasting/blob/master/gifs/SO2/batch_multioutput_SO2_Aotizhongxin.gif)


<p align="center">CO Forecasting (batch multioutput)</p>

<div align="center"> 

|               |    RMSE |     MAE |       r2 |   Pearson |   Spearman |      MBE |       IA |
|:--------------|--------:|--------:|---------:|----------:|-----------:|---------:|---------:|
| Aotizhongxin  | 836.6   | 470.507 | 0.645866 |  0.806733 |   0.763815 |  39.0379 | 0.875146 |
| Changping     | 738.13  | 410.45  | 0.595305 |  0.772848 |   0.757123 | -27.5401 | 0.865606 |
| Dingling      | 603.645 | 325.837 | 0.624838 |  0.790922 |   0.764384 | -25.6389 | 0.873291 |
| Dongsi        | 785.527 | 464.478 | 0.616083 |  0.786025 |   0.745663 | -44.8515 | 0.867234 |
| Guanyuan      | 771.561 | 433.473 | 0.605799 |  0.778612 |   0.754091 | -25.5299 | 0.865749 |
| Gucheng       | 768.117 | 437.182 | 0.628331 |  0.793596 |   0.75354  | -45.7525 | 0.877386 |
| Huairou       | 579.815 | 327.663 | 0.652362 |  0.809028 |   0.774038 | -35.1585 | 0.882299 |
| Nongzhanguan  | 833.002 | 474.947 | 0.618897 |  0.786934 |   0.76179  | -19.7366 | 0.869267 |
| Shunyi        | 814.919 | 476.588 | 0.617902 |  0.7899   |   0.739969 | -19.1054 | 0.859381 |
| Tiantan       | 782.744 | 447.724 | 0.617708 |  0.786853 |   0.755076 | -40.0306 | 0.86792  |
| Wanliu        | 800.674 | 454.828 | 0.625068 |  0.792178 |   0.75146  | -39.3074 | 0.880093 |
| Wanshouxigong | 778.814 | 469.63  | 0.636317 |  0.799902 |   0.755187 | -72.4079 | 0.876594 |

</div> 

![](https://github.com/EvanBagis/Beijing_Air_Quality_Forecasting/blob/master/gifs/CO/batch_multioutput_CO_Aotizhongxin.gif)



### TODO

- define the spliting timestamps
- regular forecasting 1 (single station, only lags, reccursive)
- regular forecasting 2 (single station, all other covariates)
- advanced forecasting 1 (STCV forecasting)
- advanced forecasting 2 (multiple stations, multiple forecasting steps, multioutput)
# Beijing_Air_Quality_Forecasting
## Introduction
### Conceptual framework

### Results
<p align="center">O3 Forecasting (incremental recursive)</p>

<div align="center"> 

|                  |    RMSE |     MAE |       r2 |   Pearson |   Spearman |     MBE |       IA |
|:-----------------|--------:|--------:|---------:|----------:|-----------:|--------:|---------:|
| O3_Aotizhongxin  | 36.8965 | 26.206  | 0.589671 |  0.769434 |   0.727027 | 1.67756 | 0.864245 |
| O3_Changping     | 36.489  | 25.5166 | 0.550848 |  0.744649 |   0.72921  | 1.5507  | 0.847123 |
| O3_Dingling      | 41.3024 | 27.1911 | 0.612244 |  0.786155 |   0.724094 | 1.45451 | 0.877414 |
| O3_Dongsi        | 41.6883 | 26.0071 | 0.495461 |  0.706663 |   0.729984 | 2.41213 | 0.815854 |
| O3_Guanyuan      | 37.1439 | 26.3129 | 0.579683 |  0.763166 |   0.729014 | 1.91978 | 0.859598 |
| O3_Gucheng       | 36.2974 | 25.9818 | 0.61183  |  0.783817 |   0.728101 | 2.02202 | 0.873734 |
| O3_Huairou       | 38.0058 | 26.9535 | 0.56064  |  0.752238 |   0.701549 | 2.25581 | 0.853636 |
| O3_Nongzhanguan  | 37.1621 | 26.9692 | 0.594916 |  0.772719 |   0.713458 | 2.14099 | 0.864643 |
| O3_Shunyi        | 36.8168 | 26.2197 | 0.550216 |  0.743857 |   0.687703 | 2.10562 | 0.845719 |
| O3_Tiantan       | 41.4814 | 27.9079 | 0.535473 |  0.733942 |   0.718654 | 1.94942 | 0.838346 |
| O3_Wanliu        | 34.6942 | 24.1088 | 0.5943   |  0.77246  |   0.705959 | 1.85735 | 0.865736 |
| O3_Wanshouxigong | 36.1836 | 26.0143 | 0.599616 |  0.77593  |   0.728532 | 1.66164 | 0.868447 |

</div> 


<div align="center"> 

|                  |    RMSE |     MAE |       r2 |   Pearson |   Spearman |     MBE |       IA |
|:-----------------|--------:|--------:|---------:|----------:|-----------:|--------:|---------:|
| O3_Aotizhongxin  | 36.8965 | 26.206  | 0.589671 |  0.769434 |   0.727027 | 1.67756 | 0.864245 |
| O3_Changping     | 36.489  | 25.5166 | 0.550848 |  0.744649 |   0.72921  | 1.5507  | 0.847123 |
| O3_Dingling      | 41.3024 | 27.1911 | 0.612244 |  0.786155 |   0.724094 | 1.45451 | 0.877414 |
| O3_Dongsi        | 41.6883 | 26.0071 | 0.495461 |  0.706663 |   0.729984 | 2.41213 | 0.815854 |
| O3_Guanyuan      | 37.1439 | 26.3129 | 0.579683 |  0.763166 |   0.729014 | 1.91978 | 0.859598 |
| O3_Gucheng       | 36.2974 | 25.9818 | 0.61183  |  0.783817 |   0.728101 | 2.02202 | 0.873734 |
| O3_Huairou       | 38.0058 | 26.9535 | 0.56064  |  0.752238 |   0.701549 | 2.25581 | 0.853636 |
| O3_Nongzhanguan  | 37.1621 | 26.9692 | 0.594916 |  0.772719 |   0.713458 | 2.14099 | 0.864643 |
| O3_Shunyi        | 36.8168 | 26.2197 | 0.550216 |  0.743857 |   0.687703 | 2.10562 | 0.845719 |
| O3_Tiantan       | 41.4814 | 27.9079 | 0.535473 |  0.733942 |   0.718654 | 1.94942 | 0.838346 |
| O3_Wanliu        | 34.6942 | 24.1088 | 0.5943   |  0.77246  |   0.705959 | 1.85735 | 0.865736 |
| O3_Wanshouxigong | 36.1836 | 26.0143 | 0.599616 |  0.77593  |   0.728532 | 1.66164 | 0.868447 |

</div> 

<p align="center">PM10 Forecasting (incremental recursive)</p>

<div align="center"> 

|                    |    RMSE |     MAE |       r2 |   Pearson |   Spearman |      MBE |       IA |
|:-------------------|--------:|--------:|---------:|----------:|-----------:|---------:|---------:|
| PM10_Aotizhongxin  | 81.7281 | 56.392  | 0.265638 |  0.550185 |   0.550286 | -3.02448 | 0.721973 |
| PM10_Changping     | 70.9678 | 47.3576 | 0.286312 |  0.561449 |   0.568515 | -2.07087 | 0.726262 |
| PM10_Dingling      | 67.4707 | 44.8073 | 0.29334  |  0.571868 |   0.563936 | -1.89691 | 0.737251 |
| PM10_Dongsi        | 84.4856 | 58.4192 | 0.259487 |  0.539158 |   0.523387 | -2.54374 | 0.709819 |
| PM10_Guanyuan      | 79.821  | 55.5428 | 0.255184 |  0.539381 |   0.52287  | -3.56245 | 0.712592 |
| PM10_Gucheng       | 85.3588 | 60.7417 | 0.23583  |  0.517096 |   0.498773 | -4.31654 | 0.692164 |
| PM10_Huairou       | 72.5723 | 48.7725 | 0.273234 |  0.551219 |   0.56011  | -1.66423 | 0.719875 |
| PM10_Nongzhanguan  | 82.1932 | 57.2188 | 0.269949 |  0.544428 |   0.525393 | -1.29396 | 0.712048 |
| PM10_Shunyi        | 78.9329 | 53.6038 | 0.26099  |  0.537197 |   0.54106  | -0.73137 | 0.705453 |
| PM10_Tiantan       | 77.822  | 54.1875 | 0.259418 |  0.537136 |   0.511079 | -2.42328 | 0.707001 |
| PM10_Wanliu        | 79.7831 | 55.7012 | 0.273593 |  0.560194 |   0.538783 | -4.80564 | 0.73164  |
| PM10_Wanshouxigong | 84.8766 | 58.9289 | 0.260443 |  0.538788 |   0.504123 | -2.5333  | 0.709844 |

</div> 


<div align="center"> 

|                    |    RMSE |     MAE |       r2 |   Pearson |   Spearman |      MBE |       IA |
|:-------------------|--------:|--------:|---------:|----------:|-----------:|---------:|---------:|
| PM10_Aotizhongxin  | 81.7281 | 56.392  | 0.265638 |  0.550185 |   0.550286 | -3.02448 | 0.721973 |
| PM10_Changping     | 70.9678 | 47.3576 | 0.286312 |  0.561449 |   0.568515 | -2.07087 | 0.726262 |
| PM10_Dingling      | 67.4707 | 44.8073 | 0.29334  |  0.571868 |   0.563936 | -1.89691 | 0.737251 |
| PM10_Dongsi        | 84.4856 | 58.4192 | 0.259487 |  0.539158 |   0.523387 | -2.54374 | 0.709819 |
| PM10_Guanyuan      | 79.821  | 55.5428 | 0.255184 |  0.539381 |   0.52287  | -3.56245 | 0.712592 |
| PM10_Gucheng       | 85.3588 | 60.7417 | 0.23583  |  0.517096 |   0.498773 | -4.31654 | 0.692164 |
| PM10_Huairou       | 72.5723 | 48.7725 | 0.273234 |  0.551219 |   0.56011  | -1.66423 | 0.719875 |
| PM10_Nongzhanguan  | 82.1932 | 57.2188 | 0.269949 |  0.544428 |   0.525393 | -1.29396 | 0.712048 |
| PM10_Shunyi        | 78.9329 | 53.6038 | 0.26099  |  0.537197 |   0.54106  | -0.73137 | 0.705453 |
| PM10_Tiantan       | 77.822  | 54.1875 | 0.259418 |  0.537136 |   0.511079 | -2.42328 | 0.707001 |
| PM10_Wanliu        | 79.7831 | 55.7012 | 0.273593 |  0.560194 |   0.538783 | -4.80564 | 0.73164  |
| PM10_Wanshouxigong | 84.8766 | 58.9289 | 0.260443 |  0.538788 |   0.504123 | -2.5333  | 0.709844 |

</div> 

<p align="center">PM2.5 Forecasting (incremental recursive)</p>

<div align="center"> 

|                     |    RMSE |     MAE |       r2 |   Pearson |   Spearman |       MBE |       IA |
|:--------------------|--------:|--------:|---------:|----------:|-----------:|----------:|---------:|
| PM2.5_Aotizhongxin  | 67.3144 | 44.3056 | 0.330909 |  0.601158 |   0.576775 | -0.428074 | 0.760379 |
| PM2.5_Changping     | 58.0815 | 37.5036 | 0.356913 |  0.626477 |   0.615474 | -1.09951  | 0.780996 |
| PM2.5_Dingling      | 59.3523 | 37.5378 | 0.37084  |  0.636735 |   0.614739 | -0.756778 | 0.787458 |
| PM2.5_Dongsi        | 71.8054 | 47.8766 | 0.30835  |  0.582576 |   0.557451 | -0.741635 | 0.745999 |
| PM2.5_Guanyuan      | 66.4305 | 44.1553 | 0.3325   |  0.603657 |   0.566361 | -1.39296  | 0.762926 |
| PM2.5_Gucheng       | 67.0345 | 44.1332 | 0.35135  |  0.612936 |   0.572902 | -0.984412 | 0.766042 |
| PM2.5_Huairou       | 58.6313 | 37.7775 | 0.321904 |  0.603223 |   0.601047 | -1.31741  | 0.7653   |
| PM2.5_Nongzhanguan  | 71.6289 | 47.3432 | 0.321966 |  0.5916   |   0.565631 |  0.17266  | 0.751424 |
| PM2.5_Shunyi        | 67.4911 | 44.4943 | 0.32422  |  0.594277 |   0.575695 |  0.253787 | 0.753375 |
| PM2.5_Tiantan       | 66.2674 | 44.657  | 0.3329   |  0.599148 |   0.564656 | -0.327437 | 0.756671 |
| PM2.5_Wanliu        | 66.3391 | 43.4595 | 0.348372 |  0.618864 |   0.587317 | -1.59709  | 0.775408 |
| PM2.5_Wanshouxigong | 71.0753 | 47.2069 | 0.326904 |  0.593771 |   0.545996 | -0.132063 | 0.752687 |

</div> 


<div align="center"> 

|                     |    RMSE |     MAE |       r2 |   Pearson |   Spearman |       MBE |       IA |
|:--------------------|--------:|--------:|---------:|----------:|-----------:|----------:|---------:|
| PM2.5_Aotizhongxin  | 67.3144 | 44.3056 | 0.330909 |  0.601158 |   0.576775 | -0.428074 | 0.760379 |
| PM2.5_Changping     | 58.0815 | 37.5036 | 0.356913 |  0.626477 |   0.615474 | -1.09951  | 0.780996 |
| PM2.5_Dingling      | 59.3523 | 37.5378 | 0.37084  |  0.636735 |   0.614739 | -0.756778 | 0.787458 |
| PM2.5_Dongsi        | 71.8054 | 47.8766 | 0.30835  |  0.582576 |   0.557451 | -0.741635 | 0.745999 |
| PM2.5_Guanyuan      | 66.4305 | 44.1553 | 0.3325   |  0.603657 |   0.566361 | -1.39296  | 0.762926 |
| PM2.5_Gucheng       | 67.0345 | 44.1332 | 0.35135  |  0.612936 |   0.572902 | -0.984412 | 0.766042 |
| PM2.5_Huairou       | 58.6313 | 37.7775 | 0.321904 |  0.603223 |   0.601047 | -1.31741  | 0.7653   |
| PM2.5_Nongzhanguan  | 71.6289 | 47.3432 | 0.321966 |  0.5916   |   0.565631 |  0.17266  | 0.751424 |
| PM2.5_Shunyi        | 67.4911 | 44.4943 | 0.32422  |  0.594277 |   0.575695 |  0.253787 | 0.753375 |
| PM2.5_Tiantan       | 66.2674 | 44.657  | 0.3329   |  0.599148 |   0.564656 | -0.327437 | 0.756671 |
| PM2.5_Wanliu        | 66.3391 | 43.4595 | 0.348372 |  0.618864 |   0.587317 | -1.59709  | 0.775408 |
| PM2.5_Wanshouxigong | 71.0753 | 47.2069 | 0.326904 |  0.593771 |   0.545996 | -0.132063 | 0.752687 |

</div> 

<p align="center">NO2 Forecasting (incremental recursive)</p>

<div align="center"> 

|                   |    RMSE |     MAE |       r2 |   Pearson |   Spearman |       MBE |       IA |
|:------------------|--------:|--------:|---------:|----------:|-----------:|----------:|---------:|
| NO2_Aotizhongxin  | 31.1846 | 23.3236 | 0.28985  |  0.558611 |   0.542429 | -0.926497 | 0.724208 |
| NO2_Changping     | 24.287  | 18.0132 | 0.32906  |  0.591602 |   0.554678 | -0.82965  | 0.748695 |
| NO2_Dingling      | 21.1008 | 14.1584 | 0.35725  |  0.620028 |   0.574388 | -0.583915 | 0.773977 |
| NO2_Dongsi        | 28.8476 | 21.3878 | 0.299991 |  0.570869 |   0.544084 | -1.02992  | 0.736741 |
| NO2_Guanyuan      | 29.6077 | 22.1364 | 0.292938 |  0.56893  |   0.545296 | -1.44848  | 0.73716  |
| NO2_Gucheng       | 31.8828 | 24.1499 | 0.23854  |  0.523828 |   0.487362 | -0.746365 | 0.70735  |
| NO2_Huairou       | 21.4652 | 15.136  | 0.333951 |  0.603187 |   0.599985 | -0.937804 | 0.761637 |
| NO2_Nongzhanguan  | 31.1045 | 23.5003 | 0.27284  |  0.546073 |   0.519343 | -0.93289  | 0.717468 |
| NO2_Shunyi        | 26.3893 | 19.5465 | 0.303414 |  0.568653 |   0.525082 | -0.446382 | 0.732769 |
| NO2_Tiantan       | 26.719  | 20.118  | 0.302728 |  0.568909 |   0.543467 | -0.732492 | 0.730966 |
| NO2_Wanliu        | 30.3577 | 22.6904 | 0.369851 |  0.626028 |   0.601046 | -1.63229  | 0.776294 |
| NO2_Wanshouxigong | 29.7458 | 22.1495 | 0.320685 |  0.588867 |   0.557933 | -1.20803  | 0.751341 |

</div> 


<div align="center"> 

|                   |    RMSE |     MAE |       r2 |   Pearson |   Spearman |       MBE |       IA |
|:------------------|--------:|--------:|---------:|----------:|-----------:|----------:|---------:|
| NO2_Aotizhongxin  | 31.1846 | 23.3236 | 0.28985  |  0.558611 |   0.542429 | -0.926497 | 0.724208 |
| NO2_Changping     | 24.287  | 18.0132 | 0.32906  |  0.591602 |   0.554678 | -0.82965  | 0.748695 |
| NO2_Dingling      | 21.1008 | 14.1584 | 0.35725  |  0.620028 |   0.574388 | -0.583915 | 0.773977 |
| NO2_Dongsi        | 28.8476 | 21.3878 | 0.299991 |  0.570869 |   0.544084 | -1.02992  | 0.736741 |
| NO2_Guanyuan      | 29.6077 | 22.1364 | 0.292938 |  0.56893  |   0.545296 | -1.44848  | 0.73716  |
| NO2_Gucheng       | 31.8828 | 24.1499 | 0.23854  |  0.523828 |   0.487362 | -0.746365 | 0.70735  |
| NO2_Huairou       | 21.4652 | 15.136  | 0.333951 |  0.603187 |   0.599985 | -0.937804 | 0.761637 |
| NO2_Nongzhanguan  | 31.1045 | 23.5003 | 0.27284  |  0.546073 |   0.519343 | -0.93289  | 0.717468 |
| NO2_Shunyi        | 26.3893 | 19.5465 | 0.303414 |  0.568653 |   0.525082 | -0.446382 | 0.732769 |
| NO2_Tiantan       | 26.719  | 20.118  | 0.302728 |  0.568909 |   0.543467 | -0.732492 | 0.730966 |
| NO2_Wanliu        | 30.3577 | 22.6904 | 0.369851 |  0.626028 |   0.601046 | -1.63229  | 0.776294 |
| NO2_Wanshouxigong | 29.7458 | 22.1495 | 0.320685 |  0.588867 |   0.557933 | -1.20803  | 0.751341 |

</div> 

<p align="center">SO2 Forecasting (incremental recursive)</p>

<div align="center"> 

|                   |    RMSE |      MAE |       r2 |   Pearson |   Spearman |      MBE |       IA |
|:------------------|--------:|---------:|---------:|----------:|-----------:|---------:|---------:|
| SO2_Aotizhongxin  | 16.845  |  9.5642  | 0.455382 |  0.683697 |   0.737945 | 0.688624 | 0.806793 |
| SO2_Changping     | 14.9766 |  8.30125 | 0.496441 |  0.710752 |   0.716355 | 0.645894 | 0.824948 |
| SO2_Dingling      | 12.2236 |  6.92943 | 0.384576 |  0.631267 |   0.648586 | 0.584819 | 0.767902 |
| SO2_Dongsi        | 17.254  | 10.3885  | 0.436252 |  0.672529 |   0.690384 | 0.568025 | 0.8026   |
| SO2_Guanyuan      | 17.6054 |  9.97773 | 0.445868 |  0.680721 |   0.704886 | 0.440125 | 0.808609 |
| SO2_Gucheng       | 21.1812 |  8.66976 | 0.386368 |  0.642376 |   0.781353 | 0.541529 | 0.776498 |
| SO2_Huairou       | 14.5159 |  7.36825 | 0.411804 |  0.651235 |   0.659598 | 0.931055 | 0.778861 |
| SO2_Nongzhanguan  | 18.1729 | 10.7067  | 0.445818 |  0.67896  |   0.693621 | 0.629714 | 0.806547 |
| SO2_Shunyi        | 15.7022 |  8.67599 | 0.355754 |  0.615091 |   0.6395   | 0.942754 | 0.758328 |
| SO2_Tiantan       | 16.1976 |  8.91268 | 0.376575 |  0.624364 |   0.645524 | 1.04707  | 0.757889 |
| SO2_Wanliu        | 15.6117 |  9.02633 | 0.52909  |  0.73338  |   0.770534 | 0.501529 | 0.842705 |
| SO2_Wanshouxigong | 17.6885 |  9.93005 | 0.469139 |  0.693748 |   0.734777 | 0.65127  | 0.81521  |

</div> 


<div align="center"> 

|                   |    RMSE |      MAE |       r2 |   Pearson |   Spearman |      MBE |       IA |
|:------------------|--------:|---------:|---------:|----------:|-----------:|---------:|---------:|
| SO2_Aotizhongxin  | 16.845  |  9.5642  | 0.455382 |  0.683697 |   0.737945 | 0.688624 | 0.806793 |
| SO2_Changping     | 14.9766 |  8.30125 | 0.496441 |  0.710752 |   0.716355 | 0.645894 | 0.824948 |
| SO2_Dingling      | 12.2236 |  6.92943 | 0.384576 |  0.631267 |   0.648586 | 0.584819 | 0.767902 |
| SO2_Dongsi        | 17.254  | 10.3885  | 0.436252 |  0.672529 |   0.690384 | 0.568025 | 0.8026   |
| SO2_Guanyuan      | 17.6054 |  9.97773 | 0.445868 |  0.680721 |   0.704886 | 0.440125 | 0.808609 |
| SO2_Gucheng       | 21.1812 |  8.66976 | 0.386368 |  0.642376 |   0.781353 | 0.541529 | 0.776498 |
| SO2_Huairou       | 14.5159 |  7.36825 | 0.411804 |  0.651235 |   0.659598 | 0.931055 | 0.778861 |
| SO2_Nongzhanguan  | 18.1729 | 10.7067  | 0.445818 |  0.67896  |   0.693621 | 0.629714 | 0.806547 |
| SO2_Shunyi        | 15.7022 |  8.67599 | 0.355754 |  0.615091 |   0.6395   | 0.942754 | 0.758328 |
| SO2_Tiantan       | 16.1976 |  8.91268 | 0.376575 |  0.624364 |   0.645524 | 1.04707  | 0.757889 |
| SO2_Wanliu        | 15.6117 |  9.02633 | 0.52909  |  0.73338  |   0.770534 | 0.501529 | 0.842705 |
| SO2_Wanshouxigong | 17.6885 |  9.93005 | 0.469139 |  0.693748 |   0.734777 | 0.65127  | 0.81521  |

</div> 

<p align="center">CO Forecasting (incremental recursive)</p>

<div align="center"> 

|                  |     RMSE |     MAE |       r2 |   Pearson |   Spearman |        MBE |       IA |
|:-----------------|---------:|--------:|---------:|----------:|-----------:|-----------:|---------:|
| CO_Aotizhongxin  |  966.063 | 598.284 | 0.395307 |  0.641384 |   0.566211 |  19.2822   | 0.780875 |
| CO_Changping     |  886.218 | 531.083 | 0.382025 |  0.636212 |   0.59414  |  -3.46301  | 0.779179 |
| CO_Dingling      |  697.415 | 413.547 | 0.396787 |  0.643978 |   0.621483 |  13.1205   | 0.78474  |
| CO_Dongsi        |  932.61  | 580.981 | 0.397358 |  0.642634 |   0.556844 |   5.21744  | 0.783754 |
| CO_Guanyuan      |  918.814 | 577.557 | 0.366635 |  0.624243 |   0.54299  |  -4.13781  | 0.772944 |
| CO_Gucheng       |  923.517 | 575.337 | 0.442258 |  0.681062 |   0.591768 | -30.1879   | 0.814372 |
| CO_Huairou       |  748.337 | 465.778 | 0.300955 |  0.579131 |   0.553769 |  -6.56367  | 0.741708 |
| CO_Nongzhanguan  | 1023.5   | 647.662 | 0.340227 |  0.603504 |   0.527852 |   4.40408  | 0.756825 |
| CO_Shunyi        |  971.733 | 606.459 | 0.312073 |  0.57975  |   0.536381 |  17.4615   | 0.737203 |
| CO_Tiantan       |  950.546 | 605.542 | 0.356151 |  0.615829 |   0.526351 |   0.100057 | 0.767241 |
| CO_Wanliu        |  989.578 | 607.758 | 0.391064 |  0.643966 |   0.576308 |  -6.38525  | 0.787496 |
| CO_Wanshouxigong |  970.603 | 626.669 | 0.386275 |  0.63687  |   0.543133 |  -1.28225  | 0.781551 |

</div> 



### TODO

- define the spliting timestamps
- regular forecasting 1 (single station, only lags, reccursive)
- regular forecasting 2 (single station, all other covariates)
- advanced forecasting 1 (STCV forecasting)
- advanced forecasting 2 (multiple stations, multiple forecasting steps, multioutput)